var div=d3.select("body").append("div").attr("class","tooltip").style("opacity",0),margin={top:40,right:100,bottom:20,left:80},height=600+margin.top+margin.bottom,width=960+margin.left+margin.right,duration=750,tree=d3.layout.tree().size([width-20,height-40]),root={},nodes=tree(root);root.parent=root,root.px=root.x,root.py=root.y;var diagonal=d3.svg.diagonal(),svg=d3.select("#chart").append("svg").attr("width",width).attr("height",height).style("background-color","#f7f7f9").append("g").attr("transform","translate(10,10)"),node=svg.selectAll(".node"),link=svg.selectAll(".link");function setRootData(a){var b=nodes[0];b.url=a.url,b.root=a.root,b.children=a.children,b.status=a.status,b.title=a.title,b.id=0}function update(a){a.id=nodes.length;var b=a,c=nodes[0];if(c.hasOwnProperty("url"))for(var e=0;e<nodes.length;e++)if(nodes[e].url===a.root){c=nodes[e];break}c.children?c.children.push(b):c.children=[b],nodes.push(b),node=node.data(tree.nodes(root),function(g){return g.id}),link=link.data(tree.links(nodes),function(g){return g.source.id+"-"+g.target.id}),node.enter().append("circle").attr("class",function(g){if("Keyword Found"===g.status)return"keywordNode";return"Error"===g.status?"errorNode":"node"}).attr("r",4).attr("cx",function(g){return g.parent.px}).attr("cy",function(g){return g.parent.py}).on("mouseover",function(g){div.transition().duration(200).style("opacity",.9),div.html("<b>Title:</b> "+g.title+"<br><b>URL:</b> "+g.url).style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(){div.transition().duration(500).style("opacity",0)}).on("click",function(g){window.open(g.url,"_blank")}),link.enter().insert("path",".node").attr("class","link").attr("d",function(g){var h={x:g.source.px,y:g.source.py};return diagonal({source:h,target:h})});var f=svg.transition().duration(duration);f.selectAll(".link").attr("d",diagonal),f.selectAll("circle").attr("cx",function(g){return g.px=g.x}).attr("cy",function(g){return g.py=g.y})}function showChartArea(){$("#chart-area").show(),$("#log-tab").removeClass("inactive-tab"),$("#log-tab").addClass("active-tab"),$("#node-tab").addClass("inactive-tab"),$("#node-tab").removeClass("active-tab")}function hideChartArea(){$("#chart-area").hide(),$("#log-tab").removeClass("inactive-tab"),$("#log-tab").addClass("active-tab"),$("#node-tab").addClass("inactive-tab"),$("#node-tab").removeClass("active-tab")}function clearChart(){d3.selectAll("svg").remove(),root={},nodes=tree(root),root.parent=root,root.px=root.x,root.py=root.y,diagonal=d3.svg.diagonal(),svg=d3.select("#chart").append("svg").attr("width",width).attr("height",height).style("background-color","#f7f7f9").append("g").attr("transform","translate(10,10)"),node=svg.selectAll(".node"),link=svg.selectAll(".link"),duration=750}$(document).ready(function(){$("#node-tab").on("click",function(){showChartArea(),hideTextArea()})});